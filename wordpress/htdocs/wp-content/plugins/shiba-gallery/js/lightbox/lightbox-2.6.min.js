(function(){var $,Lightbox,LightboxOptions;$=jQuery;LightboxOptions=(function(){function LightboxOptions(){this.fadeDuration=500;this.fitImagesInViewport=true;this.resizeDuration=700;this.showImageNumberLabel=true;this.wrapAround=false}LightboxOptions.prototype.albumLabel=function(a,b){return"Image "+a+" of "+b};return LightboxOptions})();Lightbox=(function(){function Lightbox(a){this.options=a;this.album=[];this.currentImageIndex=void 0;this.init()}Lightbox.prototype.init=function(){this.enable();return this.build()};Lightbox.prototype.enable=function(){var a=this;this.lblinks=$('a[rel^=lightbox], area[rel^=lightbox], a[data-lightbox], area[data-lightbox]');return $(this.lblinks).on('click',function(e){a.start($(e.currentTarget));return false})};Lightbox.prototype.build=function(){var a=this;$("<div id='lightboxOverlay' class='lightboxOverlay'></div><div id='lightbox' class='lightbox'><div class='lb-outerContainer'><div class='lb-container'><img class='lb-image' src='' /><div class='lb-nav'><a class='lb-prev' href='' ></a><a class='lb-next' href='' ></a></div><div class='lb-loader'><a class='lb-cancel'></a></div></div></div><div class='lb-dataContainer'><div class='lb-data'><div class='lb-details'><span class='lb-caption'></span><span class='lb-number'></span></div><div class='lb-closeContainer'><a class='lb-close'></a></div></div></div></div>").appendTo($('body'));this.$lightbox=$('#lightbox');this.$overlay=$('#lightboxOverlay');this.$outerContainer=this.$lightbox.find('.lb-outerContainer');this.$container=this.$lightbox.find('.lb-container');this.containerTopPadding=parseInt(this.$container.css('padding-top'),10);this.containerRightPadding=parseInt(this.$container.css('padding-right'),10);this.containerBottomPadding=parseInt(this.$container.css('padding-bottom'),10);this.containerLeftPadding=parseInt(this.$container.css('padding-left'),10);this.$overlay.hide().on('click',function(){a.end();return false});this.$lightbox.hide().on('click',function(e){if($(e.target).attr('id')==='lightbox'){a.end()}return false});this.$outerContainer.on('click',function(e){if($(e.target).attr('id')==='lightbox'){a.end()}return false});this.$lightbox.find('.lb-prev').on('click',function(){if(a.currentImageIndex===0){a.changeImage(a.album.length-1)}else{a.changeImage(a.currentImageIndex-1)}return false});this.$lightbox.find('.lb-next').on('click',function(){if(a.currentImageIndex===a.album.length-1){a.changeImage(0)}else{a.changeImage(a.currentImageIndex+1)}return false});this.$lightbox.find('.lb-caption').on('click',function(e){if(e.target.href){window.location.href=e.target.href;return false}});return this.$lightbox.find('.lb-loader, .lb-close').on('click',function(){a.end();return false})};Lightbox.prototype.start=function(b){var c,a,dataLightboxValue,i,imageNumber,left,top,_i,_j,_len,_len1,_ref,_ref1;$(window).on("resize",this.sizeOverlay);$('select, object, embed').css({visibility:"hidden"});this.$overlay.width($(document).width()).height($(document).height()).fadeIn(this.options.fadeDuration);this.album=[];imageNumber=0;dataLightboxValue=b.attr('data-lightbox');if(dataLightboxValue){_ref=$(this.lblinks).filter(b.prop("tagName")+'[data-lightbox="'+dataLightboxValue+'"]');for(i=_i=0,_len=_ref.length;_i<_len;i=++_i){a=_ref[i];this.album.push({link:$(a).attr('href'),title:$(a).attr('title')});if($(a).attr('href')===b.attr('href')){imageNumber=i}}}else{if(b.attr('rel')==='lightbox'){this.album.push({link:b.attr('href'),title:b.attr('title')})}else{_ref1=$(this.lblinks).filter(b.prop("tagName")+'[rel="'+b.attr('rel')+'"]');for(i=_j=0,_len1=_ref1.length;_j<_len1;i=++_j){a=_ref1[i];this.album.push({link:$(a).attr('href'),title:$(a).attr('title')});if($(a).attr('href')===b.attr('href')){imageNumber=i}}}}c=$(window);top=c.scrollTop()+c.height()/10;left=c.scrollLeft();this.$lightbox.css({top:top+'px',left:left+'px'}).fadeIn(this.options.fadeDuration);this.changeImage(imageNumber);};Lightbox.prototype.changeImage=function(b){var c,preloader,_this=this;this.disableKeyboardNav();c=this.$lightbox.find('.lb-image');this.sizeOverlay();this.$overlay.fadeIn(this.options.fadeDuration);$('.lb-loader').fadeIn('slow');this.$lightbox.find('.lb-image, .lb-nav, .lb-prev, .lb-next, .lb-dataContainer, .lb-numbers, .lb-caption').hide();this.$outerContainer.addClass('animating');preloader=new Image();preloader.onload=function(){var a,imageHeight,imageWidth,maxImageHeight,maxImageWidth,windowHeight,windowWidth;c.attr('src',_this.album[b].link);a=$(preloader);imageWidth=preloader.width;imageHeight=preloader.height;c.width(preloader.width);c.height(preloader.height);if(_this.options.fitImagesInViewport){windowWidth=$(window).width();windowHeight=$(window).height();maxImageWidth=windowWidth-_this.containerLeftPadding-_this.containerRightPadding-20;maxImageHeight=windowHeight-_this.containerTopPadding-_this.containerBottomPadding-110;if((preloader.width>maxImageWidth)||(preloader.height>maxImageHeight)){if((preloader.width/maxImageWidth)>(preloader.height/maxImageHeight)){imageWidth=maxImageWidth;imageHeight=parseInt(preloader.height/(preloader.width/imageWidth),10);c.width(imageWidth);c.height(imageHeight)}else{imageHeight=maxImageHeight;imageWidth=parseInt(preloader.width/(preloader.height/imageHeight),10);c.width(imageWidth);c.height(imageHeight)}}}return _this.sizeContainer(imageWidth,imageHeight)};preloader.src=this.album[b].link;this.currentImageIndex=b};Lightbox.prototype.sizeOverlay=function(){return $('#lightboxOverlay').width($(document).width()).height($(document).height())};Lightbox.prototype.sizeContainer=function(a,b){var c,newWidth,oldHeight,oldWidth,_this=this;oldWidth=this.$outerContainer.outerWidth();oldHeight=this.$outerContainer.outerHeight();newWidth=a+this.containerLeftPadding+this.containerRightPadding;c=b+this.containerTopPadding+this.containerBottomPadding;this.$outerContainer.animate({width:newWidth,height:c},this.options.resizeDuration,'swing');setTimeout(function(){_this.$lightbox.find('.lb-dataContainer').width(newWidth);_this.$lightbox.find('.lb-prevLink').height(c);_this.$lightbox.find('.lb-nextLink').height(c);_this.showImage()},this.options.resizeDuration)};Lightbox.prototype.showImage=function(){this.$lightbox.find('.lb-loader').hide();this.$lightbox.find('.lb-image').fadeIn('slow');this.updateNav();this.updateDetails();this.preloadNeighboringImages();this.enableKeyboardNav()};Lightbox.prototype.updateNav=function(){this.$lightbox.find('.lb-nav').show();if(this.album.length>1){if(this.options.wrapAround){this.$lightbox.find('.lb-prev, .lb-next').show()}else{if(this.currentImageIndex>0){this.$lightbox.find('.lb-prev').show()}if(this.currentImageIndex<this.album.length-1){this.$lightbox.find('.lb-next').show()}}}};Lightbox.prototype.updateDetails=function(){var a=this;if(typeof this.album[this.currentImageIndex].title!=='undefined'&&this.album[this.currentImageIndex].title!==""){this.$lightbox.find('.lb-caption').html(this.album[this.currentImageIndex].title).fadeIn('fast')}if(this.album.length>1&&this.options.showImageNumberLabel){this.$lightbox.find('.lb-number').text(this.options.albumLabel(this.currentImageIndex+1,this.album.length)).fadeIn('fast')}else{this.$lightbox.find('.lb-number').hide()}this.$outerContainer.removeClass('animating');this.$lightbox.find('.lb-dataContainer').fadeIn(this.resizeDuration,function(){return a.sizeOverlay()})};Lightbox.prototype.preloadNeighboringImages=function(){var a,preloadPrev;if(this.album.length>this.currentImageIndex+1){a=new Image();a.src=this.album[this.currentImageIndex+1].link}if(this.currentImageIndex>0){preloadPrev=new Image();preloadPrev.src=this.album[this.currentImageIndex-1].link}};Lightbox.prototype.enableKeyboardNav=function(){$(document).on('keyup.keyboard',$.proxy(this.keyboardAction,this))};Lightbox.prototype.disableKeyboardNav=function(){$(document).off('.keyboard')};Lightbox.prototype.keyboardAction=function(a){var b,KEYCODE_LEFTARROW,KEYCODE_RIGHTARROW,key,keycode;b=27;KEYCODE_LEFTARROW=37;KEYCODE_RIGHTARROW=39;keycode=a.keyCode;key=String.fromCharCode(keycode).toLowerCase();if(keycode===b||key.match(/x|o|c/)){this.end()}else if(key==='p'||keycode===KEYCODE_LEFTARROW){if(this.currentImageIndex!==0){this.changeImage(this.currentImageIndex-1)}}else if(key==='n'||keycode===KEYCODE_RIGHTARROW){if(this.currentImageIndex!==this.album.length-1){this.changeImage(this.currentImageIndex+1)}}};Lightbox.prototype.end=function(){this.disableKeyboardNav();$(window).off("resize",this.sizeOverlay);this.$lightbox.fadeOut(this.options.fadeDuration);this.$overlay.fadeOut(this.options.fadeDuration);return $('select, object, embed').css({visibility:"visible"})};return Lightbox})();$(function(){var a,options;options=new LightboxOptions();return a=new Lightbox(options)})}).call(this);