var noobSlide=new Class({initialize:function(a){this.items=a.items;var b=this;this.imgs=a.box.getElements('img');this.links=a.box.getElements('a');this.descriptions=a.box.getElements('p');this.stage=a.box.parentNode;this.main=this.stage.parentNode.parentNode;this.info=this.stage.getElement('.shiba-caption');this.cap=new Array();this.crop=a.crop||false;this.responsive=a.responsive||false;this.aspect=a.aspect||0;this.panel=a.panel||false;this.mode=a.mode||'horizontal';this.modes={horizontal:['left','width'],vertical:['top','height']};this.size=a.size||240;this.box=a.box.setStyle(this.modes[this.mode][1],(this.size*this.items.length)+'px');this.button_event=a.button_event||'click';this.handle_event=a.handle_event||'click';this.onWalk=a.onWalk||null;this.currentIndex=null;this.previousIndex=null;this.nextIndex=null;this.interval=a.interval||5000;this.autoPlay=a.autoPlay||false;this._play=null;this.handles=a.handles||null;if(this.handles){this.addHandleButtons(this.handles)}this.buttons={previous:[],next:[],play:[],playback:[],stop:[]};if(a.addButtons){for(var c in a.addButtons){this.addActionButtons(c,$type(a.addButtons[c])=='array'?a.addButtons[c]:[a.addButtons[c]])}}this.fx=new Fx.Tween(this.box,$extend((a.fxOptions||{duration:500,wait:false}),{property:this.modes[this.mode][0]}));this.walk((a.startItem||0),true,true);this.wrapper=new Array();if(this.responsive){this.origWidth=0;for(var i=0;i<this.items.length;i++){this.items[i].style.visibility='hidden';var d=this.items[i].getChildren();if(d.length<=2)this.wrapper[i]=new Element('span').addClass('wrapper').wraps(this.imgs[i]);else{this.wrapper[i]=new Element('span').addClass('wrapper');this.wrapper[i].style.visibility='visible';d.each(function(e){b.wrapper[i].wraps(e)})}this.wrapper[i].style.width=this.items[i].style.width;this.wrapper[i].style.height=this.items[i].style.height}this.imgs[0].style.visibility='visible';shibaResizeFunctions.push(this.resize.bind(this));this.initResize()}},addHandleButtons:function(a){for(var i=0;i<a.length;i++){a[i].addEvent(this.handle_event,this.walk.bind(this,[i,true]))}},addActionButtons:function(a,b){for(var i=0;i<b.length;i++){switch(a){case'previous':b[i].addEvent(this.button_event,this.previous.bind(this,[true]));break;case'next':b[i].addEvent(this.button_event,this.next.bind(this,[true]));break;case'play':b[i].addEvent(this.button_event,this.play.bind(this,[this.interval,'next',false]));break;case'playback':b[i].addEvent(this.button_event,this.play.bind(this,[this.interval,'previous',false]));break;case'stop':b[i].addEvent(this.button_event,this.stop.bind(this));break}this.buttons[a].push(b[i])}},previous:function(a){this.walk((this.currentIndex>0?this.currentIndex-1:this.items.length-1),a)},next:function(a){this.walk((this.currentIndex<this.items.length-1?this.currentIndex+1:0),a)},play:function(a,b,c){this.stop();if(!c){this[b](false)}this._play=this[b].periodical(a,this,[false])},stop:function(){$clear(this._play)},walk:function(a,b,c){if(a!=this.currentIndex){this.currentIndex=a;this.previousIndex=this.currentIndex+(this.currentIndex>0?-1:this.items.length-1);this.nextIndex=this.currentIndex+(this.currentIndex<this.items.length-1?1:1-this.items.length);if(b){this.stop()}if(c){this.fx.cancel().set((this.size*-this.currentIndex)+'px')}else{this.fx.cancel().start(this.size*-this.currentIndex)}if(b&&this.autoPlay){this.play(this.interval,'next',true);this.autoPlay=false}if(this.onWalk){this.onWalk((this.items[this.currentIndex]||null),(this.handles&&this.handles[this.currentIndex]?this.handles[this.currentIndex]:null))}if(this.responsive&&this.wrapper)this.resizeImg()}},active:function(i){var a=i>0?i:this.currentIndex,l=this.links[a];jQuery(l).click()},initResize:function(){var a=this.imgs;if(a[0].naturalWidth<=1){window.setTimeout(this.initResize.bind(this),1000)}else this.origWidth=0;this.resize()},resize:function(){if(this.stage.offsetWidth==this.origWidth)return;this.origWidth=this.stage.offsetWidth;this.resizeImg()},resizeImg:function(){var a=this.imgs;var b=this.stage;var m=this.imgs[this.currentIndex];var p=this.wrapper[this.currentIndex];m.style.visibility='visible';if(a[this.c+1]){a[this.c+1].style.visibility='hidden'}if(a[this.c-1]){a[this.c-1].style.visibility='hidden'}if(this.aspect){b.style.height=(this.aspect*b.offsetWidth)+'px';p.style.width=b.offsetWidth+'px';p.style.height=b.offsetHeight+'px';shibaGallery.updateImg(m);return}else if(this.panel){p.style.width=b.offsetWidth+'px';return}p.style.width=b.offsetWidth+'px';p.style.height=b.offsetHeight+'px';shibaGallery.adjustWidth(m,b,this.crop)}});